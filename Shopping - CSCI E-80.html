<!DOCTYPE html>
<!-- saved from url=(0070)https://cs50.harvard.edu/extension/ai/2020/spring/projects/4/shopping/ -->
<html lang="en-us"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta property="og:description" content="">

<meta property="og:image" content=""><meta property="og:title" content="Shopping - CSCI E-80">

<meta property="og:url" content=""><link href="https://cs50.harvard.edu/extension/ai/2020/spring/favicon.ico?1584977932" rel="icon">

<!-- https://fontawesome.com/how-to-use/on-the-web/referencing-icons/basic-use -->
<link href="./Shopping - CSCI E-80_files/all.min.css" rel="stylesheet">

<link href="./Shopping - CSCI E-80_files/page.css" rel="stylesheet">

<!-- http://getbootstrap.com/docs/4.3/getting-started/introduction/ -->
<script src="./Shopping - CSCI E-80_files/jquery.min.js"></script>
<script src="./Shopping - CSCI E-80_files/popper.min.js"></script>
<script src="./Shopping - CSCI E-80_files/bootstrap.min.js"></script>

<!-- https://github.com/pellepim/jstimezonedetect -->
<script src="./Shopping - CSCI E-80_files/jstz.min.js"></script>

<!-- https://momentjs.com/, https://momentjs.com/timezone/ -->
<script src="./Shopping - CSCI E-80_files/moment.min.js"></script>
<script src="./Shopping - CSCI E-80_files/moment-timezone-with-data.min.js"></script>



<script src="./Shopping - CSCI E-80_files/jekyll-theme-cs50.js"></script>

<title>Shopping - CSCI E-80</title>
</head>

    <body>

        <div class="container-fluid">

            <div class="row">

                <aside class="col-md">
 
                    <header><h1 data-id="csci-e-80"><a href="https://cs50.harvard.edu/extension/ai/2020/spring/">CSCI E-80</a></h1>

<p class="h5">CS50’s Introduction to<br>
Artificial Intelligence<br>
with Python</p>

<p><a href="https://www.extension.harvard.edu/">Harvard Extension School</a><br>
Spring 2020</p></header>

                    

                    <button aria-controls="nav" aria-expanded="false" class="btn btn-sm collapsed d-md-none" data-target="aside &gt; nav" data-toggle="collapse">
                        Menu
                    </button>

                    <nav class="collapse d-md-block"><hr>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><a href="https://cs50.harvard.edu/extension/ai/2020/spring/#announcements">Announcements</a></li>
</ul>

<hr>

<ol start="0">
  <li><a href="https://cs50.harvard.edu/extension/ai/2020/spring/#search">Search</a></li>
  <li><a href="https://cs50.harvard.edu/extension/ai/2020/spring/#knowledge">Knowledge</a></li>
  <li><a href="https://cs50.harvard.edu/extension/ai/2020/spring/#uncertainty">Uncertainty</a></li>
  <li><a href="https://cs50.harvard.edu/extension/ai/2020/spring/#optimization">Optimization</a></li>
  <li><a href="https://cs50.harvard.edu/extension/ai/2020/spring/#learning">Learning</a></li>
</ol>

<hr>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><a href="https://vault.cs50.io/1aefc6c7-e592-4657-ac38-3adb9aaebf69">Ed Discussion</a> for Q&amp;A</li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-circle"></i></span><a href="https://cs50.harvard.edu/extension/ai/2020/spring/quickstart.pdf">Quick Start Guide</a></li>
</ul>

<hr>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><a href="https://cs50.harvard.edu/extension/ai/2020/spring/lectures/">Lectures</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><a href="https://cs50.harvard.edu/extension/ai/2020/spring/hours/">Office Hours</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><a href="https://cs50.harvard.edu/extension/ai/2020/spring/projects/">Projects</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><a href="https://cs50.harvard.edu/extension/ai/2020/spring/sections/">Sections</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><a href="https://cs50.harvard.edu/extension/ai/2020/spring/staff/">Staff</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><a href="https://cs50.harvard.edu/extension/ai/2020/spring/syllabus/">Syllabus</a></li>
</ul></nav>

                    <footer></footer>

                </aside>

                <main class="col-md markdown-body" style="margin-bottom: 446px;">

                    <h1 id="shopping"><a data-id="" href="https://cs50.harvard.edu/extension/ai/2020/spring/projects/4/shopping/#shopping">Shopping</a></h1>

<p>Write an AI to predict whether online shopping customers will complete a purchase.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python shopping.py shopping.csv
Correct: 4088
Incorrect: 844
True Positive Rate: 41.02%
True Negative Rate: 90.55%
</code></pre></div></div>

<h2 id="background"><a data-id="" href="https://cs50.harvard.edu/extension/ai/2020/spring/projects/4/shopping/#background">Background</a></h2>

<p>When users are shopping online, not all will end up purchasing something. Most visitors to an online shopping website, in fact, likely don’t end up going through with a purchase during that web browsing session. It might be useful, though, for a shopping website to be able to predict whether a user intends to make a purchase or not: perhaps displaying different content to the user, like showing the user a discount offer if the website believes the user isn’t planning to complete the purchase. How could a website determine a user’s purchasing intent? That’s where machine learning will come in.</p>

<p>Your task in this problem is to build a nearest-neighbor classifier to solve this problem. Given information about a user — how many pages they’ve visited, whether they’re shopping on a weekend, what web browser they’re using, etc. — your classifier will predict whether or not the user will make a purchase. Your classifier won’t be perfectly accurate — perfectly modeling human behavior is a task well beyond the scope of this class — but it should be better than guessing randomly. To train your classifier, we’ll provide you with some data from a shopping website from about 12,000 users sessions.</p>

<p>How do we measure the accuracy of a system like this? If we have a testing data set, we could run our classifier on the data, and compute what proportion of the time we correctly classify the user’s intent. This would give us a single accuracy percentage. But that number might be a little misleading. Imagine, for example, if about 15% of all users end up going through with a purchase. A classifier that always predicted that the user would not go through with a purchase, then, we would measure as being 85% accurate: the only users it classifies incorrectly are the 15% of users who do go through with a purchase. And while 85% accuracy sounds pretty good, that doesn’t seem like a very useful classifier.</p>

<p>Instead, we’ll measure two values: sensitivity (also known as the “true positive rate”) and specificity (also known as the “true negative rate”). Sensitivity refers to the proportion of positive examples that were correctly identified: in other words, the proportion of users who did go through with a purchase who were correctly identified. Specificity refers to the proportion of negative examples that were correctly identified: in this case, the proportion of users who did not go through with a purchase who were correctly identified. So our “always guess no” classifier from before would have perfect specificity (1.0) but no sensitivity (0.0). Our goal is to build a classifier that performs reasonably on both metrics.</p>

<h2 id="getting-started"><a data-id="" href="https://cs50.harvard.edu/extension/ai/2020/spring/projects/4/shopping/#getting-started">Getting Started</a></h2>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span>Download the distribution code from <a href="https://cdn.cs50.net/ai/2020/spring/projects/4/shopping.zip">https://cdn.cs50.net/ai/2020/spring/projects/4/shopping.zip</a> and unzip it.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span>Run <code class="highlighter-rouge">pip3 install scikit-learn</code> to install the <code class="highlighter-rouge">scikit-learn</code> package if it isn’t already installed, which you’ll need for this project.</li>
</ul>

<h2 id="understanding"><a data-id="" href="https://cs50.harvard.edu/extension/ai/2020/spring/projects/4/shopping/#understanding">Understanding</a></h2>

<p>First, open up <code class="highlighter-rouge">shopping.csv</code>, the data set provided to you for this project. You can open it in a text editor, but you may find it easier to understand visually in a spreadsheet application like Microsoft Excel, Apple Numbers, or Google Sheets.</p>

<p>There are about 12,000 user sessions represented in this spreadsheet: represented as one row for each user session. The first six columns measure the different types of pages users have visited in the session: the <code class="highlighter-rouge">Administrative</code>, <code class="highlighter-rouge">Informational</code>, and <code class="highlighter-rouge">ProductRelated</code> columns measure how many of those types of pages the user visited, and their corresponding <code class="highlighter-rouge">_Duration</code> columns measure how much time the user spent on any of those pages. The <code class="highlighter-rouge">BounceRates</code>, <code class="highlighter-rouge">ExitRates</code>, and <code class="highlighter-rouge">PageValues</code> columns measure information from Google Analytics about the page the user visited. <code class="highlighter-rouge">SpecialDay</code> is a value that measures how closer the date of the user’s session is to a special day (like Valentine’s Day or Mother’s Day). <code class="highlighter-rouge">Month</code> is an abbreviation of the month the user visited. <code class="highlighter-rouge">OperatingSystems</code>, <code class="highlighter-rouge">Browser</code>, <code class="highlighter-rouge">Region</code>, and <code class="highlighter-rouge">TrafficType</code> are all integers describing information about the user themself. <code class="highlighter-rouge">VisitorType</code> will take on the value <code class="highlighter-rouge">Returning_Visitor</code> for returning visitors and <code class="highlighter-rouge">New_Visitor</code> for new visitors to the site. <code class="highlighter-rouge">Weekend</code> is <code class="highlighter-rouge">TRUE</code> or <code class="highlighter-rouge">FALSE</code> depending on whether or not the user is visiting on a weekend.</p>

<p>Perhaps the most important column, though, is the last one: the <code class="highlighter-rouge">Revenue</code> column. This is the column that indicates whether the user ultimately made a purchase or not: <code class="highlighter-rouge">TRUE</code> if they did, <code class="highlighter-rouge">FALSE</code> if they didn’t. This is the column that we’d like to learn to predict (the “label”), based on the values for all of the other columns (the “evidence”).</p>

<p>Next, take a look at <code class="highlighter-rouge">shopping.py</code>. The <code class="highlighter-rouge">main</code> function loads data from a CSV spreadsheet by calling the <code class="highlighter-rouge">load_data</code> function and splits the data into a training and testing set. The <code class="highlighter-rouge">train_model</code> function is then called to train a machine learning model on the training data. Then, the model is used to make predictions on the testing data set. Finally, the <code class="highlighter-rouge">evaluate</code> function determines the sensitivity and specificity of the model, before the results are ultimately printed to the terminal.</p>

<p>The functions <code class="highlighter-rouge">load_data</code>, <code class="highlighter-rouge">train_model</code>, and <code class="highlighter-rouge">evaluate</code> are left blank. That’s where you come in!</p>

<h2 id="specification"><a data-id="" href="https://cs50.harvard.edu/extension/ai/2020/spring/projects/4/shopping/#specification">Specification</a></h2>

<p>Complete the implementation of <code class="highlighter-rouge">load_data</code>, <code class="highlighter-rouge">train_model</code>, and <code class="highlighter-rouge">evaluate</code> in <code class="highlighter-rouge">shopping.py</code>.</p>

<p>The <code class="highlighter-rouge">load_data</code> function should accept a CSV filename as its argument, open that file, and return a tuple <code class="highlighter-rouge">(evidence, labels)</code>. <code class="highlighter-rouge">evidence</code> should be a list of all of the evidence for each of the data points, and <code class="highlighter-rouge">labels</code> should be a list of all of the labels for each data point.</p>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span>Since you’ll have one piece of evidence and one label for each row of the spreadsheet, the length of the <code class="highlighter-rouge">evidence</code> list and the length of the <code class="highlighter-rouge">labels</code> list should ultimately be equal to the number of rows in the CSV spreadsheet (excluding the header row). The lists should be ordered according to the order the users appear in the spreadsheet. That is to say, <code class="highlighter-rouge">evidence[0]</code> should be the evidence for the first user, and <code class="highlighter-rouge">labels[0]</code> should be the label for the first user.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span>Each element in the <code class="highlighter-rouge">evidence</code> list should itself be a list. The list should be of length 17: the number of columns in the spreadsheet excluding the final column (the label column).</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span>The values in each <code class="highlighter-rouge">evidence</code> list should be in the same order as the columns that appear in the evidence spreadsheet. You may assume that the order of columns in <code class="highlighter-rouge">shopping.csv</code> will always be presented in that order.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span>Note that, to build a nearest-neighbor classifier, all of our data needs to be numeric. Be sure that your values have the following types:
    <ul class="fa-ul">
      <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><code class="highlighter-rouge">Administrative</code>, <code class="highlighter-rouge">Informational</code>, <code class="highlighter-rouge">ProductRelated</code>, <code class="highlighter-rouge">Month</code>, <code class="highlighter-rouge">OperatingSystems</code>, <code class="highlighter-rouge">Browser</code>, <code class="highlighter-rouge">Region</code>, <code class="highlighter-rouge">TrafficType</code>, <code class="highlighter-rouge">VisitorType</code>, and <code class="highlighter-rouge">Weekend</code> should all be of type <code class="highlighter-rouge">int</code></li>
      <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><code class="highlighter-rouge">Administrative_Duration</code>, <code class="highlighter-rouge">Informational_Duration</code>, <code class="highlighter-rouge">ProductRelated_Duration</code>, <code class="highlighter-rouge">BounceRates</code>, <code class="highlighter-rouge">ExitRates</code>, <code class="highlighter-rouge">PageValues</code>, and <code class="highlighter-rouge">SpecialDay</code> should all be of type <code class="highlighter-rouge">float</code>.</li>
      <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><code class="highlighter-rouge">Month</code> should be <code class="highlighter-rouge">0</code> for January, <code class="highlighter-rouge">1</code> for February, <code class="highlighter-rouge">2</code> for March, etc. up to <code class="highlighter-rouge">11</code> for December.</li>
      <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><code class="highlighter-rouge">VisitorType</code> should be <code class="highlighter-rouge">1</code> for returning visitors and <code class="highlighter-rouge">0</code> for non-returning visitors.</li>
      <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><code class="highlighter-rouge">Weekend</code> should be <code class="highlighter-rouge">1</code> if the user visited on a weekend and <code class="highlighter-rouge">0</code> otherwise.</li>
    </ul>
  </li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span>Each value of <code class="highlighter-rouge">labels</code> should either be the integer <code class="highlighter-rouge">1</code>, if the user did go through with a purchase, or <code class="highlighter-rouge">0</code> otherwise.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span>For example, the value of the first evidence list should be <code class="highlighter-rouge">[0, 0.0, 0, 0.0, 1, 0.0, 0.2, 0.2, 0.0, 0.0, 1, 1, 1, 1, 1, 1, 0]</code> and the value of the first label should be <code class="highlighter-rouge">0</code>.</li>
</ul>

<p>The <code class="highlighter-rouge">train_model</code> function should accept a list of evidence and a list of labels, and return a <code class="highlighter-rouge">scikit-learn</code> nearest-neighbor classifier (a k-nearest-neighbor classifier where <code class="highlighter-rouge">k = 1</code>) fitted on that training data.</p>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span>Notice that we’ve already imported for you <code class="highlighter-rouge">from sklearn.neighbors import KNeighborsClassifier</code>. You’ll want to use a <code class="highlighter-rouge">KNeighborsClassifier</code> in this function.</li>
</ul>

<p>The <code class="highlighter-rouge">evaluate</code> function should accept a list of <code class="highlighter-rouge">labels</code> (the true labels for the users in the testing set) and a list of <code class="highlighter-rouge">predictions</code> (the labels predicted by your classifier), and return two floating-point values <code class="highlighter-rouge">(sensitivity, specificity)</code>.</p>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><code class="highlighter-rouge">sensitivity</code> should be a floating-point value from 0 to 1 representing the “true positive rate”: the proportion of actual positive labels that were accurately identified.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span><code class="highlighter-rouge">specificity</code> should be a floating-point value from 0 to 1 representing the “true negative rate”: the proportion of actual negative labels that were accurately identified.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span>You may assume each label will be <code class="highlighter-rouge">1</code> for positive results (users who did go through with a purchase) or <code class="highlighter-rouge">0</code> for negative results (users who did not go through with a purchase).</li>
</ul>

<p>You should not modify anything else in <code class="highlighter-rouge">shopping.py</code> other than the functions the specification calls for you to implement, though you may write additional functions and/or import other Python standard library modules. You may also import <code class="highlighter-rouge">numpy</code> or <code class="highlighter-rouge">pandas</code> or anything from <code class="highlighter-rouge">scikit-learn</code>, if familiar with them, but you should not use any other third-party Python modules. You should not modify <code class="highlighter-rouge">shopping.csv</code>.</p>

<h2 id="hints"><a data-id="" href="https://cs50.harvard.edu/extension/ai/2020/spring/projects/4/shopping/#hints">Hints</a></h2>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-circle"></i></span>For information and examples about how to load data from a CSV file, see Python’s <a href="https://docs.python.org/3/library/csv.html">CSV documentation</a>.</li>
</ul>

<h2 id="how-to-submit"><a data-id="" href="https://cs50.harvard.edu/extension/ai/2020/spring/projects/4/shopping/#how-to-submit">How to Submit</a></h2>

<p>If you don’t already have it installed, install <code class="highlighter-rouge">submit50</code> by running <code class="highlighter-rouge">pip3 install submit50</code>. Then, execute the below, logging in with your GitHub username and password when prompted. For security, you’ll see asterisks (<code class="highlighter-rouge">*</code>) instead of the actual characters in your password.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>submit50 ai50/problems/2020/spring/shopping
</code></pre></div></div>

<h2 id="acknowledgements"><a data-id="" href="https://cs50.harvard.edu/extension/ai/2020/spring/projects/4/shopping/#acknowledgements">Acknowledgements</a></h2>

<p>Data set provided by <a href="https://link.springer.com/article/10.1007%2Fs00521-018-3523-0">Sakar, C.O., Polat, S.O., Katircioglu, M. et al. Neural Comput &amp; Applic (2018)</a></p>


                </main>

            </div>

        </div>

        
 
    


</body></html>